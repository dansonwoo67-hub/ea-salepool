<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EA Coverage Dashboard</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <h1>EA Coverage & Follow-up Recommendations</h1>
  </header>

  <main>
    <section class="card">
      <h2>Upload 2 Excel files (T1 vs T2)</h2>
      <div class="grid2">
        <div class="box">
          <h3>T1 (older)</h3>
          <input id="file1" type="file" accept=".xlsx,.xls" />
          <div id="t1meta" class="meta"></div>
        </div>

        <div class="box">
          <h3>T2 (newer)</h3>
          <input id="file2" type="file" accept=".xlsx,.xls" />
          <input id="teamFilter" type="text" placeholder="Optional: Team filter (exact name)" />
          <div id="t2meta" class="meta"></div>
        </div>
      </div>

      <div class="actions">
        <button id="btnLoad" class="btn">Load</button>
        <button id="btnAnalyze" class="btn primary" disabled>Analyze</button>
      </div>
    </section>

    <section class="card" id="mappingCard" style="display:none;">
      <h2>Column mapping (only if needed)</h2>
      <div id="mappingArea" class="mapping"></div>
      <div class="actions">
        <button id="btnApplyMapping" class="btn">Apply mapping</button>
      </div>
    </section>

    <section class="card" id="resultsCard" style="display:none;">
      <h2>Results</h2>

      <div class="tabs">
        <button class="tab active" data-tab="tabCoverage">Coverage delta</button>
        <button class="tab" data-tab="tabFirstFollow">First vs Follow-up</button>
        <button class="tab" data-tab="tabRecommend">Top 20 follow-ups / EA</button>
      </div>

      <div id="tabCoverage" class="tabpane active">
        <div class="toolbar">
          <button class="btn" id="exportCoverage">Export CSV</button>
        </div>
        <div id="coverageTable" class="tableWrap"></div>
      </div>

      <div id="tabFirstFollow" class="tabpane">
        <div class="toolbar">
          <button class="btn" id="exportFirstFollow">Export CSV</button>
        </div>
        <div id="firstFollowTable" class="tableWrap"></div>
      </div>

      <div id="tabRecommend" class="tabpane">
        <div class="toolbar">
          <button class="btn" id="exportRecommend">Export CSV</button>
        </div>
        <div id="recommendTable" class="tableWrap"></div>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
